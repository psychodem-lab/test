<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel Psychologa - System Diagnostyczny</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #2563eb;
            --bg: #f8fafc;
            --surface: #ffffff;
            --text: #0f172a;
            --muted: #64748b;
            --border: #e2e8f0;
            --accent: #4f46e5;
        }

        /* --- Global Reset & Mobile --- */
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg);
            color: var(--text);
            line-height: 1.5;
            -webkit-tap-highlight-color: transparent;
        }

        /* --- Login Screen --- */
        #login-screen {
            position: fixed; inset: 0; background: var(--bg);
            display: flex; align-items: center; justify-content: center; z-index: 2000;
            padding: 20px;
        }
        .login-card {
            background: var(--surface); padding: 2rem; border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.05); width: 100%; max-width: 400px;
            text-align: center;
        }
        .login-card h2 { margin-bottom: 1.5rem; }
        .login-card input {
            width: 100%; padding: 0.8rem; margin-bottom: 1rem;
            border: 1px solid var(--border); border-radius: 8px; font-size: 1rem;
        }

        /* --- Dashboard Layout --- */
        #dashboard { display: none; padding: 1rem; max-width: 900px; margin: 0 auto; }
        
        header {
            background: var(--surface); padding: 1.5rem; border-radius: 12px;
            margin-bottom: 1rem; border: 1px solid var(--border);
        }
        .patient-data {
            display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 1rem;
        }
        input[type="text"], input[type="date"] {
            width: 100%; padding: 0.6rem; border: 1px solid var(--border); border-radius: 6px;
            font-family: inherit; font-size: 0.9rem;
        }

        /* --- Tabs --- */
        .nav-tabs {
            display: flex; gap: 8px; overflow-x: auto; padding-bottom: 8px;
            margin-bottom: 1.5rem; scrollbar-width: none;
        }
        .nav-tabs::-webkit-scrollbar { display: none; }
        .tab-link {
            flex: 0 0 auto; background: var(--surface); border: 1px solid var(--border);
            padding: 8px 16px; border-radius: 20px; cursor: pointer; font-size: 0.85rem;
            font-weight: 500; transition: 0.2s;
        }
        .tab-link.active { background: var(--primary); color: white; border-color: var(--primary); }

        /* --- Test Content --- */
        .test-section { display: none; background: var(--surface); border-radius: 12px; padding: 1.5rem; border: 1px solid var(--border); }
        .test-section.active { display: block; }
        .test-header { margin-bottom: 1.5rem; border-bottom: 1px solid var(--border); padding-bottom: 1rem; }
        .test-header h2 { font-size: 1.25rem; }
        .test-header p { font-size: 0.85rem; color: var(--muted); margin-top: 4px; }

        /* --- Question UI --- */
        .question-row { margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 1px outline var(--bg); }
        .q-text { font-weight: 500; display: block; margin-bottom: 0.75rem; font-size: 0.95rem; }
        .options-group { display: flex; gap: 8px; flex-wrap: wrap; }
        
        .opt-label {
            flex: 1; min-width: 60px; display: flex; flex-direction: column; align-items: center;
            padding: 10px; border: 1px solid var(--border); border-radius: 8px; cursor: pointer;
            font-size: 0.8rem; transition: 0.2s; text-align: center;
        }
        .opt-label:hover { background: #f1f5f9; }
        .opt-label input { margin-bottom: 4px; }
        .opt-label.selected { background: #e0e7ff; border-color: var(--primary); }

        /* --- Result Styling --- */
        .result-panel {
            margin-top: 2rem; padding: 1.5rem; background: #f1f5f9; border-radius: 8px;
            border-left: 4px solid var(--primary); display: none;
        }
        .res-line { display: flex; justify-content: space-between; margin-bottom: 0.4rem; padding: 5px 0; border-bottom: 1px solid #e2e8f0; }
        .res-line span { font-weight: bold; }

        /* --- Action Buttons --- */
        .actions {
            position: sticky; bottom: 20px; left: 0; right: 0; 
            display: flex; gap: 10px; justify-content: center; padding: 10px;
            background: rgba(248, 250, 252, 0.8); backdrop-filter: blur(8px);
        }
        .btn {
            padding: 12px 24px; border-radius: 30px; border: none; font-weight: 600;
            cursor: pointer; font-size: 0.9rem; box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            transition: transform 0.1s;
        }
        .btn:active { transform: scale(0.95); }
        .btn-calc { background: var(--accent); color: white; }
        .btn-print { background: #10b981; color: white; }

        /* --- PRINT STYLES --- */
        @media print {
            body { background: white; }
            #login-screen, .nav-tabs, .actions, .btn-calc, header h1 { display: none !important; }
            #dashboard { display: block !important; padding: 0; width: 100%; }
            .test-section { display: none !important; }
            .test-section.active { display: block !important; border: none !important; }
            .result-panel { display: block !important; background: white !important; border: 1px solid #000 !important; }
            input { border: none !important; font-weight: bold; }
        }

        @media (max-width: 600px) {
            .options-group { display: grid; grid-template-columns: 1fr; }
            .opt-label { flex-direction: row; gap: 10px; text-align: left; }
        }
    </style>
</head>
<body>

<div id="login-screen">
    <div class="login-card">
        <h2>Panel Psychologa</h2>
        <input type="password" id="pass" placeholder="Hasło">
        <button class="btn btn-calc" style="width:100%" onclick="login()">Zaloguj się</button>
    </div>
</div>

<div id="dashboard">
    <header>
        <h1>System Diagnostyczny</h1>
<div class="patient-data">
    <div>
        <label style="font-size:0.7rem; color:var(--muted)">Inicjały Pacjenta</label>
        <input type="text" id="p-init" placeholder="np. A.B.">
    </div>
    <div>
        <label style="font-size:0.7rem; color:var(--muted)">Płeć</label>
        <select id="p-gender" style="width: 100%; padding: 0.6rem; border: 1px solid var(--border); border-radius: 6px; font-size: 0.9rem;">
            <option value="K">Kobieta</option>
            <option value="M">Mężczyzna</option>
        </select>
    </div>
    <div>
        <label style="font-size:0.7rem; color:var(--muted)">Grupa wiekowa</label>
        <select id="p-age-group" style="width: 100%; padding: 0.6rem; border: 1px solid var(--border); border-radius: 6px; font-size: 0.9rem;">
            <option value="16-24">16 - 24 lata</option>
            <option value="25-54">25 - 54 lata</option>
            <option value="55-79">55 - 79 lat</option>
        </select>
    </div>
    <div>
        <label style="font-size:0.7rem; color:var(--muted)">Data badania</label>
        <input type="date" id="p-date">
    </div>
</div>
       
    </header>
    <nav class="nav-tabs">
        <button class="tab-link active" onclick="openTab(event, 't-dass')">DASS-21</button>
        <button class="tab-link" onclick="openTab(event, 't-dass42')">DASS-42</button>
        <button class="tab-link" onclick="openTab(event, 't-dassy')">DASSY (Dzieci)</button>
        <button class="tab-link" onclick="openTab(event, 't-bdi')">BDI-II</button>
        <button class="tab-link" onclick="openTab(event, 't-lsas')">LSAS (Leibowitz)</button>
        <button class="tab-link" onclick="openTab(event, 't-ciss')">CISS</button>
    </nav>

    <div id="t-dass" class="test-section active">
        <div class="test-header">
            <h2>DASS-21</h2>
            <p>Skala Depresji, Lęku i Stresu (0 - wcale, 3 - bardzo często).</p>
        </div>
        <form id="f-dass"></form>
        <div id="res-dass" class="result-panel"></div>
    </div>

    <div id="t-dass42" class="test-section">
        <div class="test-header"><h2>DASS-42</h2><p>Pełna Skala Depresji, Lęku i Stresu (42 pytania).</p></div>
        <form id="f-dass42"></form><div id="res-dass42" class="result-panel"></div>
    </div>

    <div id="t-dassy" class="test-section">
        <div class="test-header"><h2>DASSY</h2><p>Skala Depresji, Lęku i Stresu dla dzieci i młodzieży.</p></div>
        <form id="f-dassy"></form><div id="res-dassy" class="result-panel"></div>
    </div>

    <div id="t-phq9" class="test-section">
        <div class="test-header">
            <h2>PHQ-9</h2>
            <p>Kwestionariusz Zdrowia Pacjenta.</p>
        </div>
        <form id="f-phq9"></form>
        <div id="res-phq9" class="result-panel"></div>
    </div>

    <div id="t-gad7" class="test-section">
        <div class="test-header">
            <h2>GAD-7</h2>
            <p>Skala Lęku Uogólnionego.</p>
        </div>
        <form id="f-gad7"></form>
        <div id="res-gad7" class="result-panel"></div>
    </div>

    <div id="t-bdi" class="test-section">
        <div class="test-header">
            <h2>BDI-II</h2>
            <p>Inwentarz Depresji Becka.</p>
        </div>
        <form id="f-bdi"></form>
        <div id="res-bdi" class="result-panel"></div>
    </div>
    <div id="t-lsas" class="test-section">
        <div class="test-header">
            <h2>LSAS (Skala Leibowitza)</h2>
            <p>Ocena lęku społecznego (Lęk: 0-3, Unikanie: 0-3).</p>
        </div>
        <form id="f-lsas"></form>
        <div id="res-lsas" class="result-panel"></div>
    </div>
    <div id="t-ciss" class="test-section">
    <div class="test-header">
        <h2>CISS</h2>
        <p>Kwestionariusz Radzenia Sobie w Sytuacjach Stresowych (1 - nigdy, 5 - bardzo często).</p>
    </div>
    <form id="f-ciss"></form>
    <div id="res-ciss" class="result-panel"></div>
</div>

    <div class="actions">
        <button class="btn btn-calc" onclick="calculateCurrent()">Oblicz wynik</button>
        <button class="btn btn-print" onclick="window.print()">Drukuj / PDF</button>
    </div>
</div>

<script>
    const PASS = "psy26";

    function login() {
        if(document.getElementById('pass').value === PASS) {
            document.getElementById('login-screen').style.display = 'none';
            document.getElementById('dashboard').style.display = 'block';
            document.getElementById('p-date').valueAsDate = new Date();
            initTests();
        } else alert("Błędne hasło");
    }

    function openTab(evt, id) {
        document.querySelectorAll('.test-section').forEach(s => s.classList.remove('active'));
        document.querySelectorAll('.tab-link').forEach(b => b.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        evt.currentTarget.classList.add('active');
        window.scrollTo(0,0);
    }

    function initTests() {
        // DASS-21
        const dQ = ["Trudno było mi się uspokoić", "Czułem(am) suchość w ustach", "Nie potrafiłem(am) odczuwać żadnych pozytywnych uczuć", "Miałem(am) trudności z oddychaniem (np. szybki oddech)", "Trudno było mi nabrać inicjatywy do działania", "Miałem(am) tendencję do przesadnego reagowania", "Czułem(am) drżenie (np. rąk)", "Czułem(am), że zużywam dużo nerwowej energii", "Martwiłem(am) się sytuacjami, w których mogę wpaść w panikę", "Czułem(am), że nie mam na co czekać w przyszłości", "Czułem(am), że staję się poddenerwowany(a)", "Trudno było mi się zrelaksować", "Czułem(am) się przygnębiony(a) i smutny(a)", "Nie tolerowałem(am) niczego, co przeszkadzało mi w działaniu", "Czułem(am), że jestem bliski(a) paniki","Nie potrafiłem(am) się niczym entuzjazmować", "Czułem(am), że nie jestem wiele wart(a)", "Czułem(am), że jestem przewrażliwiony(a)", "Byłem(am) świadomy(a) rytmu serca bez wysiłku", "Czułem(am) się wystraszony(a) bez powodu", "Czułem(am), że życie nie ma sensu"];
        genForm('f-dass', dQ, 4, 'd');

        // DASS-42
        const d42Q = [
            "Trudno było mi się uspokoić", "Czułem suchość w ustach", "Nie potrafiłem odczuwać pozytywnych uczuć", "Trudności z oddychaniem", "Trudno mi było zacząć jakąś czynność", "Przesadnie reagowałem na sytuacje", "Czułem drżenie (np. rąk)", "Czułem, że zużywam dużo energii", "Bałem się sytuacji paniki", "Nie miałem na co czekać", "Stawałem się poddenerwowany", "Trudno mi było się zrelaksować", "Czułem się przygnębiony", "Nie tolerowałem przeszkód", "Czułem, że jestem bliski paniki", "Brak entuzjazmu", "Czułem, że nie jestem wiele wart", "Byłem przewrażliwiony", "Świadomość rytmu serca", "Bałem się bez powodu", "Czułem, że życie nie ma sensu", "Trudno mi było się odprężyć", "Problemy z połykaniem", "Brak radości z czegokolwiek", "Świadomość bicia serca", "Czułem smutek i przygnębienie", "Byłem bardzo drażliwy", "Byłem bliski paniki", "Trudno mi było się wyciszyć", "Bałem się, że coś mnie przerazi", "Brak entuzjazmu dla planów", "Trudno mi było zacząć działanie", "Czułem, że jestem do niczego", "Byłem nietolerancyjny", "Czułem brak tchu", "Czułem brak nadziei", "Życie wydawało mi się bezwartościowe", "Łatwo wpadałem w irytację", "Pociłem się (bez upału/wysiłku)", "Bałem się bez konkretnego powodu", "Czułem, że życie jest bez sensu", "Trudno było mi się uspokoić po zdenerwowaniu"
        ];
        genForm('f-dass42', d42Q, 4, 'd42');

        // DASSY
        const dyQ = [
            "Denerwowałem/am się z powodu drobnych rzeczy", "Czułem/am zawroty głowy, jakbym miał/a zemdleć", "Nic mnie nie cieszyło", "Miałem/am trudności z oddychaniem (np. szybki oddech), mimo że nie ćwiczyłem/am i nie byłem/am chory", "Nienawidziłem/am swojego życia", "Reagowałem/am zbyt mocno na sytuacje", "Czułem drżenie rąk", "Martwiłem/am się o wiele rzeczy", "Byłem/am przerażony/a", "Nie było nic, na co mógłbym/mogłabym czekać z radością", "Szybko czułem irytację", "Trudno było mi się zrelaksować.", "Nie mogłem/am przestać czuć się smutny/a", "Denerwowało mnie, gdy ludzie mi przerywali.", "Miałem/am wrażenie, że zaraz spanikuję", "Nienawidziłem/am siebie", "Czułem/am, że jestem do niczego.", "Łatwo się irytowałem", "Czułem/am bardzo szybkie bicie serca, mimo że nie wykonywałem/am intensywnego wysiłku", "Czułem/am strach bez powodu", "Czułem/am, że życie jest okropne"
        ];
        genForm('f-dassy', dyQ, 4, 'dy');
        
        // PHQ-9
        const pQ = ["Małe zainteresowanie/radość", "Przygnębienie/beznadzieja", "Problemy ze snem", "Zmęczenie/brak energii", "Apetyt (brak/nadmiar)", "Poczucie porażki", "Problemy z koncentracją", "Spowolnienie/pobudzenie", "Myśli o samookaleczeniu"];
        genForm('f-phq9', pQ, 4, 'p', ["Wcale", "Kilka dni", "Połowa dni", "Codziennie"]);

        // GAD-7
        const gQ = ["Zdenerwowanie/lęk", "Brak kontroli nad martwieniem", "Martwienie się na zapas", "Trudno się odprężyć", "Niepokój ruchowy", "Irytacja", "Strach przed najgorszym"];
        genForm('f-gad7', gQ, 4, 'g', ["Wcale", "Kilka dni", "Połowa dni", "Codziennie"]);

        // BDI-II
        const bQ = [
            {q: "Smutek", o: ["Nie jestem w ogóle smutny ani przygnębiony.", "Czuję się smutny przez większość czasu.", "Jestem stale smutny i przygnębiony.", "Jestem tak nieszczęśliwy i smutny, że jest to nie do wytrzymania."]},
            {q: "Pesymizm", o: ["Nie obawiam się o swoją przyszłość.", "Obawiam się o przyszłość bardziej niż dotychczas.", "Nie oczekuję, że przyszłość będzie się dla mnie układać pomyślnie.", "Uważam, że moja przyszłość jest beznadziejna i że będzie coraz gorsza."]},
            {q: "Przeszłe niepowodzenia", o: ["Nie czuję, że odnosiłem wiele porażek.", "Zawodziłem więcej razy niż powinienem", "Patrząc wstecz, widzę dużo niepowodzeń.", "Uważam, że jako człowiek jestem totalnym nieudacznikiem."]},
            {q: "Odczuwanie przyjemności", o: ["Robienie rzeczy, które lubię dostarcza mi tyle samo przyjemności co w przeszłości.", "To co robię nie sprawia mi takiej samej przyjemności jak kiedyś.", "Odczuwam bardzo niewiele przyjemności z rzeczy, które kiedyś lubiłem.", "Nie odczuwam żadnej przyjemności z rzeczy, które kiedyś lubiłem."]},
            {q: "Poczucie winy", o: ["Nie czuje się szczególnie winien.", "Czuję się winny z powodu wielu rzeczy, które zrobiłem lub których nie zrobiłem.", "Czuję się winny przez większość czasu.", "Czuje się winny bez przerwy."]},
            {q: "Poczucie kary", o: ["Nie czuję żebym był karany.", "Czuję, że mogę zostać ukarany.", "Oczekuję kary.", "Czuję, że jestem karany."]},
            {q: "Stosunek do samego siebie", o: ["Mam o sobie takie samo zdanie jak przedtem.", "Straciłem  wiarę w siebie.", "Zawiodłem się na sobie.", "Czuję do siebie niechęć."]},
            {q: "Samokrytycyzm", o: ["Nie krytykuję siebie anie nie obwiniam więcej niż kiedyś.", "Jestem bardziej krytycznie nastawiony do siebie niż kiedyś.", "Krytykuję siebie za wszystkie swoje niepowodzenia.", "Obwiniam się za każde zło, które się wydarza."]},
            {q: "Myśli samobójcze", o: ["Nie myślę o zabiciu się.", "Myślę o tym, by się zabić, ale wiem, że bym tego nie zrobił.", "Pragnę się zabić.", "Zabije się jeśli tylko natrafi się odpowiednia do tego sposobność."]},
            {q: "Płacz", o: ["Nie płaczę częściej niż zazwyczaj.", "Płaczę częściej niż zazwyczaj.", "Płaczę ciągle, nawet z powodu drobnostek.", "Chciałbym płakać, ale nie jestem w stanie."]},
            {q: "Pobudzenie", o: ["Nie czuje się bardziej niespokojny czy pobudzony niż dawniej.", "Czuje się bardziej niespokojny czy pobudzony niż dawniej.", "Jestem tak pobudzony i niespokojny, że trudno mi się uspokoić.", "Jestem tak pobudzony i nisepokojny, że muszę wciąż coś robić lub poruszać się."]},
            {q: "Utrata zainteresowań", o: ["Ludzie i czynności codzienne interesują mnie tak jak dawniej.", "Coraz mniej interesują mnie otaczający mnie ludzie oraz czynności codzienne.", "Utraciłem większość zainteresowania ludźmi albo czynnościami codziennymi.", "Trudno mi się czymkolwiek zainteresować."]},
            {q: "Niezdecydowanie", o: ["Podejmuję decyzje tak łatwo jak kiedyś.", "Trudniej jest mi podejmować decyzje niż kiedyś.", "Mam dużą trudność w podejmowaniu decyzji.", "Nie jestem w stanie podejmować jakichkolwiek decyzji."]},
            {q: "Bezużyteczność", o: ["Nie czuję się bezwartościowy.", "Nie uważam, że jestem równie przydatny i warty uwagi jak kiedyś.", "Czuje się bardziej bezwartościowy w porównaniu do innych.", "Czuję się całkowicie bezwartościowy."]},
            {q: "Utrata energii", o: ["Mam tyle samo energii co dawniej.", "Mam mniej energii niż dawniej.", "Nie mam wystarczającej ilości energii aby wykonywać większość czynności.", "Nie mam energii aby robić cokolwiek."]},
            {q: "Zmiany we wzorcu snu", o: ["Sypiam tak dobrze jak dotychczas.", "Śpię nieco więcej/mniej niż dotychczas.", "Śpię znacznie więcej/mniej niż dotychczas.", "Budzę się 1-2 godziny za wcześnie i nie mogę ponownie usnąć/ śpię przez większość dnia."]},
            {q: "Drażliwość", o: ["Nie jestem bardziej drażliwy niż zazwyczaj.", "Jestem bardziej drażliwy niż zazwyczaj.", "Jestem o wiele bardziej drażliwy niż zazwyczaj.", "Jestem drażliwy przez cały czas."]},
            {q: "Zmiany apetycie", o: ["Mam taki sam apetyt jak zwykle.", "Mam trochę mniejszy/większy apetyt niż dotychczas.", "Mam znacznie mniejszy/większy apetyt niż dotychczas.", "Nie mam w ogóle apetytu / jestem głodny cały czas."]},
            {q: "Problemy z koncentracją", o: ["Umiem się koncentrować tak dobrze jak wcześniej.", "Nie umiem koncentrować się tak dobrze jak wcześniej.", "Trudno mi skupić się na czymś przez dłuższy czas.", "Nie mogę skoncentrować się na niczym."]},
            {q: "Zmęczenie", o: ["Nie czuję się bardziej zmęczony niż dotychczas.", "Męczę się szybciej niż zazwyczaj.", "Jestem tak zmęczony, że nie mogę wykonywać wielu zadań, które dotychczas wykonywałem.", "Jestem zbyt zmęczony  żeby wykonywać większość czynności, które dotychczas wykonywałem."]},
            {q: "Utrata zainteresowania seksem", o: ["Moje zainteresowanie seksem nie uległo zmianie.", "Jestem mniej zainteresowany seksem niż dotychczas.", "Jestem obecnie dużo mniej zainteresowany seksem niż dotychczas.", "Straciłem całkowite zainteresowanie seksem."]}
        ];
        genFormBDI('f-bdi', bQ, 'b');

        // LSAS (Leibowitz)
        const lQ = [
            "Rozmawianie przez telefon przy innych osobach", "Udział w małej grupie (parę osób)", "Jedzenie w miejscach publicznych", "Picie z innymi w miejscach publicznych", "Rozmowa z osobą na wyższym stanowisku", "Występowanie/przemawianie przed publicznością", "Pójście na imprezę", "Praca, gdy ktoś inny patrzy", "Pisanie, gdy ktoś inny patrzy", "Dzwonienie do kogoś, kogo słabo znasz", "Rozmowa z kimś, kogo słabo znasz", "Spotkanie z nieznajomymi", "Korzystanie z publicznej toalety", "Wejście do pokoju, w którym siedzą już inni", "Bycie w centrum zainteresowania", "Zabranie głosu na spotkaniu", "Przystąpienie do testu wiedzy/umiejętności", "Wyrażenie niezgody osobie mało znanej", "Patrzenie w oczy osobie mało znanej", "Przygotowany referat wygłaszany przed grupą", "Próba nawiązania bliższej relacji (podrywanie)", "Zwracanie towaru do sklepu", "Wydanie przyjęcia/imprezy", "Opieranie się presji sprzedawcy"
        ];
        genFormLSAS('f-lsas', lQ, 'l');
        
        const cissQuestions = [
    "Lepiej planuję swój czas",
    "Koncentruję się na problemie i zastanawiam się, jak mogę go rozwiązać",
    "Myślę o czasach gdy było mi lepiej",
    "Staram się przebywać z innymi ludźmi",
    "Oskarżam się o zwlekanie",
    "Robię to co uważam za najlepsze",
    "Jestem skupiony(a) na swoich dolegliwościach fizycznych",
    "Winię siebie, że wpadłem(am) w taką sytuację",
    "Włóczę się po sklepach lub przeglądam oferty",
    "Ustalam, co w danej sytuacji jest najważniejsze",
    "Staram się zasnąć",
    "Objadam się ulubioną potrawą",
    "Niepokoję się, że sobie nie poradzę",
    "Staję się bardzo napięty(a)",
    "Myślę o tym, jak rozwiązywałem(am) podobne problemy w przeszłości",
    "Wmawiam sobie, że to w rzeczywistości nie dzieje się mnie",
    "Winię siebie, że zbyt się tym przejmuję",
    "Idę coś zjeść na mieście",
    "Staje się bardzo przygnębiony(a)",
    "Kupuję sobie coś",
    "Wyznaczam sobie kierunek działania i postępuję zgodnie z nim",
    "Obwiniam siebie za to, że nie wiem co zrobić",
    "Idę się zabawić",
    "Staram się zrozumieć sytuację",
    "Zastygam w bezruchu i nie wiem co zrobić",
    "Podejmuję natychmiast właściwe działanie",
    "Analizuję sytuację i uczę się na własnych błędach",
    "Żałuję, że nie mogę zmienić tego co się stało, lub tego, co odczuwałem(am) w związku z tym",
    "Odwiedzam przyjaciela",
    "Martwię się, jak sobie z tym poradzę",
    "Spędzam czas z bliską osobą",
    "Wychodzę na spacer",
    "Wmawiam sobie, że to się nigdy więcej nie powtórzy",
    "Skupiam się na swoich ogólnych brakach",
    "Rozmawiam z kimś, kogo rady sobie cenię",
    "Analizuję problem zanim zacznę działać",
    "Dzwonię do kolegi lub koleżanki",
    "Wpadam w złość",
    "Zmieniam kolejność spraw do załatwienia",
    "Oglądam film",
    "Dążę do kontrolowania sytuacji",
    "Podejmuję dodatkowy wysiłek, aby załatwić sprawę",
    "Podchodzę do problemu z różnych stron",
    "Robię sobie wolnę, by uciec od problemu",
    "Wyładowuję się na innych",
    "Wykorzystuję sytuację, aby udowodnić, że potrafię tego dokonać",
    "Staram się tak zorganizować sprawy, aby zapanować nad sytuacją",
    "Oglądam telewizję"      
];

// Inicjalizacja formularza CISS (Skala 1-5)
genForm('f-ciss', cissQuestions, 5, 'ci', ["1", "2", "3", "4", "5"]);
    }

    function genForm(id, qs, n, prefix, labels=null) {
        const f = document.getElementById(id);
        f.innerHTML = qs.map((q, i) => `
            <div class="question-row">
                <span class="q-text">${i+1}. ${q}</span>
                <div class="options-group">
                    ${Array(n).fill(0).map((_, v) => `
                        <label class="opt-label">
                            <input type="radio" name="${prefix}${i}" value="${v}" required>
                            <span>${labels ? labels[v] : v}</span>
                        </label>
                    `).join('')}
                </div>
            </div>
        `).join('');
    }

    function genFormBDI(id, questions, prefix) {
        const f = document.getElementById(id);
        f.innerHTML = questions.map((item, i) => `
            <div class="question-row">
                <span class="q-text">${i+1}. ${item.q}</span>
                <div class="options-group">
                    ${item.o.map((opt, v) => `
                        <label class="opt-label">
                            <input type="radio" name="${prefix}${i}" value="${v}" required>
                            <span>${opt}</span>
                        </label>
                    `).join('')}
                </div>
            </div>
        `).join('');
    }

    // Generator LSAS (Podwójna punktacja)
    function genFormLSAS(id, qs, prefix) {
        const f = document.getElementById(id);
        f.innerHTML = qs.map((q, i) => `
            <div class="question-row">
                <span class="q-text">${i+1}. ${q}</span>
                <div class="lsas-label-mini">Lęk / Strach:</div>
                <div class="options-group">
                    ${["Brak", "Łagodny", "Umiark.", "Silny"].map((lbl, v) => `
                        <label class="opt-label">
                            <input type="radio" name="${prefix}f${i}" value="${v}" required>
                            <span>${lbl}</span>
                        </label>
                    `).join('')}
                </div>
                <div class="lsas-label-mini">Unikanie:</div>
                <div class="options-group">
                    ${["Nigdy", "Rzadko", "Często", "Zawsze"].map((lbl, v) => `
                        <label class="opt-label">
                            <input type="radio" name="${prefix}a${i}" value="${v}" required>
                            <span>${lbl}</span>
                        </label>
                    `).join('')}
                </div>
            </div>
        `).join('');
    }

    function calculateCurrent() {
        const activeSection = document.querySelector('.test-section.active');
        const activeId = activeSection.id;
        const inputs = activeSection.querySelectorAll('input[type="radio"]');
        const names = [...new Set([...inputs].map(i => i.name))];
        const checked = activeSection.querySelectorAll('input:checked');

        if(checked.length < names.length) {
            alert("Proszę odpowiedzieć na wszystkie pytania w tej sekcji!");
            return;
        }

        // Poprawione warunki wywoływania
        if(activeId === 't-dass') calcDASS();
        else if(activeId === 't-dass42') calcD42();
        else if(activeId === 't-dassy') calcDassy();
        else if(activeId === 't-phq9') calcPHQ();
        else if(activeId === 't-gad7') calcGAD();
        else if(activeId === 't-bdi') calcBDI();
        else if(activeId === 't-lsas') calcLSAS();
        else if(activeId === 't-ciss') calcCISS(); 
    }

    function calcDASS() {
        const getSum = (idx) => {
            let s = 0;
            idx.forEach(i => {
                const r = document.querySelector(`input[name="d${i}"]:checked`);
                if(r) s += parseInt(r.value);
            });
            return s * 2;
        };
        const d = getSum([2,4,9,12,15,16,20]);
        const a = getSum([1,3,6,8,14,18,19]);
        const s = getSum([0,5,7,10,11,13,17]);
        const interp = (v, th) => v<=th[0]?"Norma":v<=th[1]?"Łagodny":v<=th[2]?"Umiarkowany":v<=th[3]?"Silny":"B. Silny";
        
        document.getElementById('res-dass').innerHTML = `
            <h3>Wyniki DASS-21:</h3>
            <div class="res-line">Depresja: <span>${d} - ${interp(d, [9,13,20,27])}</span></div>
            <div class="res-line">Lęk: <span>${a} - ${interp(a, [7,9,14,19])}</span></div>
            <div class="res-line">Stres: <span>${s} - ${interp(s, [14,18,25,33])}</span></div>
        `;
        document.getElementById('res-dass').style.display = 'block';
    }

    function calcD42() {
        const getSum = (idx) => {
            let s = 0;
            idx.forEach(i => { const r = document.querySelector(`input[name="d42${i}"]:checked`); if(r) s += parseInt(r.value); });
            return s;
        };
        const d = getSum([2,4,9,12,15,16,20,23,25,30,33,35,36,40]);
        const a = getSum([1,3,6,8,14,18,19,22,24,27,29,34,38,39]);
        const s = getSum([0,5,7,10,11,13,17,21,26,28,31,32,37,41]);
        renderDassRes('res-dass42', d, a, s, true);
    }

    function calcDassy() {
        const getSum = (idx) => {
            let s = 0;
            idx.forEach(i => { const r = document.querySelector(`input[name="dy${i}"]:checked`); if(r) s += parseInt(r.value); });
            return s;
        };
        const d = getSum([2,4,9,12,15,16,20]), a = getSum([1,3,6,8,14,18,19]), s = getSum([0,5,7,10,11,13,17]);
        renderDassRes('res-dassy', d, a, s, false, true);
    }

    function renderDassRes(id, d, a, s, isFull=false, isDassy=false) {
        const interp = (v, th) => v<=th[0]?"Norma":v<=th[1]?"Łagodny":v<=th[2]?"Umiarkowany":v<=th[3]?"Silny":"B. Silny";
        const thD = [6,8,13,16]; 
        const thA = [5,7,12,15];
        const thS = [11,13,16,18];
        document.getElementById(id).innerHTML = `
            <h3>Wyniki ${isDassy?'DASSY':(isFull?'DASS-42':'DASS-21')}:</h3>
            <div class="res-line">Depresja: <span>${d} - ${interp(d, thD)}</span></div>
            <div class="res-line">Lęk: <span>${a} - ${interp(a, thA)}</span></div>
            <div class="res-line">Stres: <span>${s} - ${interp(s, thS)}</span></div>
        `;
        document.getElementById(id).style.display = 'block';
    }

    function calcPHQ() {
        let sum = 0;
        document.querySelectorAll('#f-phq9 input:checked').forEach(i => sum += parseInt(i.value));
        const txt = sum<=4?"Norma":sum<=9?"Łagodna":sum<=14?"Umiarkowana":sum<=19?"Umiarkowanie ciężka":"Ciężka";
        document.getElementById('res-phq9').innerHTML = `<h3>Suma PHQ-9: ${sum}</h3><p>Interpretacja: ${txt}</p>`;
        document.getElementById('res-phq9').style.display = 'block';
    }

    function calcGAD() {
        let sum = 0;
        document.querySelectorAll('#f-gad7 input:checked').forEach(i => sum += parseInt(i.value));
        const txt = sum<=4?"Norma":sum<=9?"Łagodny":sum<=14?"Umiarkowany":"Silny";
        document.getElementById('res-gad7').innerHTML = `<h3>Suma GAD-7: ${sum}</h3><p>Interpretacja: ${txt}</p>`;
        document.getElementById('res-gad7').style.display = 'block';
    }

    function calcBDI() {
        let sum = 0;
        document.querySelectorAll('#f-bdi input:checked').forEach(i => sum += parseInt(i.value));
        let interpretation = sum <= 13 ? "Minimalna" : sum <= 19 ? "Łagodna" : sum <= 28 ? "Umiarkowana" : "Ciężka";
        document.getElementById('res-bdi').innerHTML = `<h3>Suma BDI-II: ${sum} pkt</h3><p>Interpretacja: ${interpretation} depresja.</p>`;
        document.getElementById('res-bdi').style.display = 'block';
    }

    function calcLSAS() {
        let fSum = 0, aSum = 0;
        document.querySelectorAll('#f-lsas input[name^="lf"]:checked').forEach(i => fSum += parseInt(i.value));
        document.querySelectorAll('#f-lsas input[name^="la"]:checked').forEach(i => aSum += parseInt(i.value));
        const total = fSum + aSum;
        const interp = total <= 54 ? "Brak fobii" : total <= 65 ? "Łagodna" : total <= 80 ? "Umiarkowana" : total <= 95 ? "Nasilona" : "Bardzo silna";
        document.getElementById('res-lsas').innerHTML = `
            <h3>LSAS: ${total} pkt</h3>
            <div class="res-line">Lęk (suma): <span>${fSum}</span></div>
            <div class="res-line">Unikanie (suma): <span>${aSum}</span></div>
            <div class="res-line">Interpretacja: <span>${interp}</span></div>
        `;
        document.getElementById('res-lsas').style.display = 'block';
    }

    function calcCISS() {
        const ageGroup = document.getElementById('p-age-group').value; // Pobieranie grupy wiekowej
        const key = {
            ssz: [0, 1, 5, 9, 14, 20, 23, 25, 26, 35, 38, 40, 41, 42, 44, 46],
            sse: [4, 6, 7, 12, 13, 15, 16, 18, 21, 24, 27, 29, 32, 33, 37, 44],
            ssu: [2, 3, 8, 10, 11, 17, 19, 22, 28, 30, 31, 34, 36, 39, 43, 47]
        };
    
        const getScore = (indices) => {
            let sum = 0;
            indices.forEach(idx => {
                const r = document.querySelector(`input[name="ci${idx}"]:checked`);
                if(r) sum += (parseInt(r.value) + 1);
            });
            return sum;
        };
    
        const raw = { ssz: getScore(key.ssz), sse: getScore(key.sse), ssu: getScore(key.ssu) };
    
        // Nowa struktura norm oparta na wieku
        const norms = {
            '16-24': {
                ssz: [30, 39, 47, 52, 57, 61, 65, 68, 73],
                sse: [21, 26, 32, 37, 42, 50, 55, 61, 69],
                ssu: [30, 34, 39, 44, 50, 54, 59, 64, 68]
            },
            '25-54': {
                // Tutaj należy wprowadzić właściwe wartości dla tej grupy
                ssz: [38, 43, 48, 52, 57, 61, 65, 68, 74], 
                sse: [24, 30, 35, 39, 43, 51, 55, 60, 64],
                ssu: [27, 30, 34, 38, 43, 47, 52, 56, 61]
            },
            '55-79': {
                // Tutaj należy wprowadzić właściwe wartości dla tej grupy
                ssz: [37, 42, 46, 50, 55, 60, 64, 68, 72],
                sse: [26, 31, 36, 41, 45, 50, 56, 62, 69],
                ssu: [25, 31, 35, 38, 44, 49, 53, 57, 61]
            }
        };
    
        const calculateSten = (score, scaleNorms) => {
            for (let i = 0; i < scaleNorms.length; i++) {
                if (score <= scaleNorms[i]) return i + 1;
            }
            return 10;
        };
    
        const stens = {
            ssz: calculateSten(raw.ssz, norms[ageGroup].ssz),
            sse: calculateSten(raw.sse, norms[ageGroup].sse),
            ssu: calculateSten(raw.ssu, norms[ageGroup].ssu)
        };
    
        const getInterp = (s) => s <= 3 ? "Niski" : s <= 7 ? "Przeciętny" : "Wysoki";
    
        document.getElementById('res-ciss').innerHTML = `
            <h3>Wyniki CISS (Grupa wiekowa: ${ageGroup}):</h3>
            <table style="width:100%; border-collapse: collapse; margin-top:10px;">
                <tr><th>Skala</th><th>Surowy</th><th>Sten</th><th>Interpretacja</th></tr>
                <tr><td>Zadanie (SSZ)</td><td>${raw.ssz}</td><td>${stens.ssz}</td><td>${getInterp(stens.ssz)}</td></tr>
                <tr><td>Emocje (SSE)</td><td>${raw.sse}</td><td>${stens.sse}</td><td>${getInterp(stens.sse)}</td></tr>
                <tr><td>Unikanie (SSU)</td><td>${raw.ssu}</td><td>${stens.ssu}</td><td>${getInterp(stens.ssu)}</td></tr>
            </table>
        `;
        document.getElementById('res-ciss').style.display = 'block';
    }


</script>

</body>
</html>
