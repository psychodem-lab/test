<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel Psychologa - System Diagnostyczny</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #2563eb;
            --bg: #f8fafc;
            --surface: #ffffff;
            --text: #0f172a;
            --muted: #64748b;
            --border: #e2e8f0;
            --accent: #4f46e5;
        }

        /* --- Global Reset & Mobile --- */
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg);
            color: var(--text);
            line-height: 1.5;
            -webkit-tap-highlight-color: transparent;
        }

        /* --- Login Screen --- */
        #login-screen {
            position: fixed; inset: 0; background: var(--bg);
            display: flex; align-items: center; justify-content: center; z-index: 2000;
            padding: 20px;
        }
        .login-card {
            background: var(--surface); padding: 2rem; border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.05); width: 100%; max-width: 400px;
            text-align: center;
        }
        .login-card h2 { margin-bottom: 1.5rem; }
        .login-card input {
            width: 100%; padding: 0.8rem; margin-bottom: 1rem;
            border: 1px solid var(--border); border-radius: 8px; font-size: 1rem;
        }

        /* --- Dashboard Layout --- */
        #dashboard { display: none; padding: 1rem; max-width: 900px; margin: 0 auto; }
        
        header {
            background: var(--surface); padding: 1.5rem; border-radius: 12px;
            margin-bottom: 1rem; border: 1px solid var(--border);
        }
        .patient-data {
            display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 1rem;
        }
        input[type="text"], input[type="date"] {
            width: 100%; padding: 0.6rem; border: 1px solid var(--border); border-radius: 6px;
            font-family: inherit; font-size: 0.9rem;
        }

        /* --- Tabs --- */
        .nav-tabs {
            display: flex; gap: 8px; overflow-x: auto; padding-bottom: 8px;
            margin-bottom: 1.5rem; scrollbar-width: none;
        }
        .nav-tabs::-webkit-scrollbar { display: none; }
        .tab-link {
            flex: 0 0 auto; background: var(--surface); border: 1px solid var(--border);
            padding: 8px 16px; border-radius: 20px; cursor: pointer; font-size: 0.85rem;
            font-weight: 500; transition: 0.2s;
        }
        .tab-link.active { background: var(--primary); color: white; border-color: var(--primary); }

        /* --- Test Content --- */
        .test-section { display: none; background: var(--surface); border-radius: 12px; padding: 1.5rem; border: 1px solid var(--border); }
        .test-section.active { display: block; }
        .test-header { margin-bottom: 1.5rem; border-bottom: 1px solid var(--border); padding-bottom: 1rem; }
        .test-header h2 { font-size: 1.25rem; }
        .test-header p { font-size: 0.85rem; color: var(--muted); margin-top: 4px; }

        /* --- Question UI --- */
        .question-row { margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 1px outline var(--bg); }
        .q-text { font-weight: 500; display: block; margin-bottom: 0.75rem; font-size: 0.95rem; }
        .options-group { display: flex; gap: 8px; flex-wrap: wrap; }
        
        .opt-label {
            flex: 1; min-width: 60px; display: flex; flex-direction: column; align-items: center;
            padding: 10px; border: 1px solid var(--border); border-radius: 8px; cursor: pointer;
            font-size: 0.8rem; transition: 0.2s; text-align: center;
        }
        .opt-label:hover { background: #f1f5f9; }
        .opt-label input { margin-bottom: 4px; }
        .opt-label.selected { background: #e0e7ff; border-color: var(--primary); }

        /* --- Result Styling --- */
        .result-panel {
            margin-top: 2rem; padding: 1.5rem; background: #f1f5f9; border-radius: 8px;
            border-left: 4px solid var(--primary); display: none;
        }
        .res-line { display: flex; justify-content: space-between; margin-bottom: 0.4rem; padding: 5px 0; border-bottom: 1px solid #e2e8f0; }
        .res-line span { font-weight: bold; }

        /* --- Action Buttons --- */
        .actions {
            position: sticky; bottom: 20px; left: 0; right: 0; 
            display: flex; gap: 10px; justify-content: center; padding: 10px;
            background: rgba(248, 250, 252, 0.8); backdrop-filter: blur(8px);
        }
        .btn {
            padding: 12px 24px; border-radius: 30px; border: none; font-weight: 600;
            cursor: pointer; font-size: 0.9rem; box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            transition: transform 0.1s;
        }
        .btn:active { transform: scale(0.95); }
        .btn-calc { background: var(--accent); color: white; }
        .btn-print { background: #10b981; color: white; }

        /* --- PRINT STYLES --- */
        @media print {
            body { background: white; }
            #login-screen, .nav-tabs, .actions, .btn-calc, header h1 { display: none !important; }
            #dashboard { display: block !important; padding: 0; width: 100%; }
            .test-section { display: none !important; }
            .test-section.active { display: block !important; border: none !important; }
            .result-panel { display: block !important; background: white !important; border: 1px solid #000 !important; }
            input { border: none !important; font-weight: bold; }
        }

        @media (max-width: 600px) {
            .options-group { display: grid; grid-template-columns: 1fr; }
            .opt-label { flex-direction: row; gap: 10px; text-align: left; }
        }
    </style>
</head>
<body>

<div id="login-screen">
    <div class="login-card">
        <h2>Panel Psychologa</h2>
        <input type="password" id="pass" placeholder="Hasło">
        <button class="btn btn-calc" style="width:100%" onclick="login()">Zaloguj się</button>
    </div>
</div>

<div id="dashboard">
    <header>
        <h1>System Diagnostyczny</h1>
        <div class="patient-data">
            <div>
                <label style="font-size:0.7rem; color:var(--muted)">Inicjały Pacjenta</label>
                <input type="text" id="p-init" placeholder="np. A.B.">
            </div>
            <div>
                <label style="font-size:0.7rem; color:var(--muted)">Data badania</label>
                <input type="date" id="p-date">
            </div>
        </div>
    </header>

    <nav class="nav-tabs">
        <button class="tab-link active" onclick="openTab(event, 't-dass')">DASS-21</button>
        <button class="tab-link" onclick="openTab(event, 't-phq9')">PHQ-9</button>
        <button class="tab-link" onclick="openTab(event, 't-gad7')">GAD-7</button>
        <button class="tab-link" onclick="openTab(event, 't-bdi')">BDI-II</button>
    </nav>

    <div id="t-dass" class="test-section active">
        <div class="test-header">
            <h2>DASS-21</h2>
            <p>Skala Depresji, Lęku i Stresu (0 - wcale, 3 - bardzo często).</p>
        </div>
        <form id="f-dass"></form>
        <div id="res-dass" class="result-panel"></div>
    </div>

    <div id="t-phq9" class="test-section">
        <div class="test-header">
            <h2>PHQ-9</h2>
            <p>Kwestionariusz Zdrowia Pacjenta.</p>
        </div>
        <form id="f-phq9"></form>
        <div id="res-phq9" class="result-panel"></div>
    </div>

    <div id="t-gad7" class="test-section">
        <div class="test-header">
            <h2>GAD-7</h2>
            <p>Skala Lęku Uogólnionego.</p>
        </div>
        <form id="f-gad7"></form>
        <div id="res-gad7" class="result-panel"></div>
    </div>

    <div id="t-bdi" class="test-section">
        <div class="test-header">
            <h2>BDI-II</h2>
            <p>Inwentarz Depresji Becka.</p>
        </div>
        <form id="f-bdi"></form>
        <div id="res-bdi" class="result-panel"></div>
    </div>

    <div class="actions">
        <button class="btn btn-calc" onclick="calculateCurrent()">Oblicz wynik</button>
        <button class="btn btn-print" onclick="window.print()">Drukuj / PDF</button>
    </div>
</div>

<script>
    const PASS = "psycholog2026";

    function login() {
        if(document.getElementById('pass').value === PASS) {
            document.getElementById('login-screen').style.display = 'none';
            document.getElementById('dashboard').style.display = 'block';
            document.getElementById('p-date').valueAsDate = new Date();
            initTests();
        } else alert("Błędne hasło");
    }

    function openTab(evt, id) {
        document.querySelectorAll('.test-section').forEach(s => s.classList.remove('active'));
        document.querySelectorAll('.tab-link').forEach(b => b.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        evt.currentTarget.classList.add('active');
        window.scrollTo(0,0);
    }

    function initTests() {
        // DASS-21
        const dQ = ["Bardzo trudno było mi się odprężyć", "Odczuwałem/am suchość w ustach", "Nie mogłem/am doświadczać żadnych pozytywnych uczuć", "Trudności z oddychaniem", "Trudno było mi coś zacząć", "Tendencja do nadmiernego reagowania", "Odczuwałem/am drżenia", "Używałem/am dużo nerwowej energii", "Obawa przed paniką", "Czułem/am, że nic mnie nie spotka", "Czułem/am się podminowany", "Trudno się zrelaksować", "Czułem/am się przybity i smutny", "Brak tolerancji na przeszkody", "Bliskość paniki", "Brak odczuwania radości", "Poczucie niewartościowości", "Przewrażliwienie", "Bicie serca bez wysiłku", "Przestraszony bez powodu", "Życie jest bezwartościowe"];
        genForm('f-dass', dQ, 4, 'd');

        // PHQ-9
        const pQ = ["Małe zainteresowanie/radość", "Przygnębienie/beznadzieja", "Problemy ze snem", "Zmęczenie/brak energii", "Apetyt (brak/nadmiar)", "Poczucie porażki", "Problemy z koncentracją", "Spowolnienie/pobudzenie", "Myśli o samookaleczeniu"];
        genForm('f-phq9', pQ, 4, 'p', ["Wcale", "Kilka dni", "Połowa dni", "Codziennie"]);

        // GAD-7
        const gQ = ["Zdenerwowanie/lęk", "Brak kontroli nad martwieniem", "Martwienie się na zapas", "Trudno się odprężyć", "Niepokój ruchowy", "Irytacja", "Strach przed najgorszym"];
        genForm('f-gad7', gQ, 4, 'g', ["Wcale", "Kilka dni", "Połowa dni", "Codziennie"]);

        // BDI-II
        const bQ = [
            {q: "Smutek", o: ["Nie czuję się smutny.", "Czuję się smutny przez większość czasu.", "Jestem cały czas smutny.", "Jestem tak smutny, że nie mogę tego znieść."]},
            {q: "Pesymizm", o: ["Nie zniechęcam się.", "Czuję się bardziej zniechęcony.", "Nie spodziewam się, by coś się udało.", "Moja przyszłość jest beznadziejna."]},
            {q: "Poczucie porażki", o: ["Nie czuję się przegrany.", "Częściej odnosiłem porażki niż inni.", "Widzę w życiu wiele porażek.", "Poniosłem całkowitą klęskę."]},
            {q: "Utrata przyjemności", o: ["Tyle samo przyjemności co dawniej.", "Nie czerpię już tyle przyjemności.", "Bardzo mało przyjemności.", "W ogóle nie czerpię przyjemności."]},
            {q: "Poczucie winy", o: ["Nie mam poczucia winy.", "Czuję się winny z powodu wielu rzeczy.", "Przez większość czasu czuję się winny.", "Cały czas czuję się winny."]},
            {q: "Poczucie kary", o: ["Nie czuję się karany.", "Czuję, że mogę zostać ukarany.", "Spodziewam się kary.", "Czuję się karany."]},
            {q: "Niechęć do siebie", o: ["Mam taką samą opinię o sobie.", "Straciłem zaufanie do siebie.", "Jestem sobą rozczarowany.", "Nienawidzę siebie."]},
            {q: "Samokrytycyzm", o: ["Nie krytykuję siebie bardziej.", "Jestem bardziej krytyczny wobec siebie.", "Krytykuję się za wszystkie błędy.", "Obwiniam się za wszystko co złe."]},
            {q: "Myśli samobójcze", o: ["Nie myślę o tym.", "Mam myśli, ale nie zrobiłbym tego.", "Chciałbym odebrać sobie życie.", "Odebrałbym sobie życie przy okazji."]},
            {q: "Płaczliwość", o: ["Płaczę tyle co dawniej.", "Płaczę częściej.", "Płaczę z każdego drobiazgu.", "Chciałbym płakać, ale nie potrafię."]},
            {q: "Pobudzenie", o: ["Nie jestem bardziej podenerwowany.", "Bardziej podenerwowany niż zazwyczaj.", "Trudno mi ustać w miejscu.", "Muszę być w ciągłym ruchu."]},
            {q: "Utrata zainteresowań", o: ["Nie straciłem zainteresowań.", "Mniej interesuję się ludźmi.", "Straciłem większość zainteresowań.", "Trudno mi się czymkolwiek zainteresować."]},
            {q: "Niezdecydowanie", o: ["Podejmuję decyzje łatwo.", "Przychodzi mi to trudniej.", "Mam znacznie większe trudności.", "Nie mogę podjąć żadnej decyzji."]},
            {q: "Bezwartościowość", o: ["Nie czuję się bezwartościowy.", "Nie czuję się tak wartościowy jak dawniej.", "Czuję się mniej wartościowy niż inni.", "Czuję się całkowicie bezwartościowy."]},
            {q: "Brak energii", o: ["Mam tyle samo energii.", "Mam mniej energii.", "Nie mam energii na wiele rzeczy.", "Nie mam energii na nic."]},
            {q: "Zmiany snu", o: ["Brak zmian.", "Śpię nieco więcej/mniej.", "Śpię znacznie więcej/mniej.", "Budzę się wcześnie / śpię cały dzień."]},
            {q: "Drażliwość", o: ["Nie jestem bardziej drażliwy.", "Jestem bardziej drażliwy.", "Znacznie bardziej drażliwy.", "Jestem cały czas drażliwy."]},
            {q: "Zmiany apetytu", o: ["Brak zmian.", "Mniejszy/większy apetyt.", "Znacznie mniejszy/większy.", "Brak apetytu / niepohamowany."]},
            {q: "Koncentracja", o: ["Koncentruję się dobrze.", "Nie mogę się tak dobrze skupić.", "Trudno mi skupić się na dłużej.", "Nie mogę się na niczym skupić."]},
            {q: "Zmęczenie", o: ["Nie czuję się bardziej zmęczony.", "Szybciej się męczę.", "Zbyt zmęczony na wiele rzeczy.", "Zbyt zmęczony by cokolwiek robić."]},
            {q: "Seks", o: ["Brak zmian zainteresowań.", "Mniejsze zainteresowanie.", "Znacznie mniejsze zainteresowanie.", "Całkowita utrata zainteresowania."]}
        ];
        genFormBDI('f-bdi', bQ, 'b');
    }

    function genForm(id, qs, n, prefix, labels=null) {
        const f = document.getElementById(id);
        f.innerHTML = qs.map((q, i) => `
            <div class="question-row">
                <span class="q-text">${i+1}. ${q}</span>
                <div class="options-group">
                    ${Array(n).fill(0).map((_, v) => `
                        <label class="opt-label">
                            <input type="radio" name="${prefix}${i}" value="${v}" required>
                            <span>${labels ? labels[v] : v}</span>
                        </label>
                    `).join('')}
                </div>
            </div>
        `).join('');
    }

    function genFormBDI(id, questions, prefix) {
        const f = document.getElementById(id);
        f.innerHTML = questions.map((item, i) => `
            <div class="question-row">
                <span class="q-text">${i+1}. ${item.q}</span>
                <div class="options-group">
                    ${item.o.map((opt, v) => `
                        <label class="opt-label">
                            <input type="radio" name="${prefix}${i}" value="${v}" required>
                            <span>${opt}</span>
                        </label>
                    `).join('')}
                </div>
            </div>
        `).join('');
    }

    function calculateCurrent() {
        const activeSection = document.querySelector('.test-section.active');
        const activeId = activeSection.id;
        const inputs = activeSection.querySelectorAll('input[type="radio"]');
        const names = [...new Set([...inputs].map(i => i.name))];
        const checked = activeSection.querySelectorAll('input:checked');

        if(checked.length < names.length) {
            alert("Proszę odpowiedzieć na wszystkie pytania w tej sekcji!");
            return;
        }

        if(activeId === 't-dass') calcDASS();
        if(activeId === 't-phq9') calcPHQ();
        if(activeId === 't-gad7') calcGAD();
        if(activeId === 't-bdi') calcBDI();
    }

    function calcDASS() {
        const getSum = (idx) => {
            let s = 0;
            idx.forEach(i => {
                const r = document.querySelector(`input[name="d${i}"]:checked`);
                if(r) s += parseInt(r.value);
            });
            return s * 2;
        };
        const d = getSum([2,4,9,12,15,16,20]);
        const a = getSum([1,3,6,8,14,18,19]);
        const s = getSum([0,5,7,10,11,13,17]);

        const interp = (v, th) => v<=th[0]?"Norma":v<=th[1]?"Łagodny":v<=th[2]?"Umiarkowany":v<=th[3]?"Silny":"B. Silny";
        
        document.getElementById('res-dass').innerHTML = `
            <h3>Wyniki DASS-21:</h3>
            <div class="res-line">Depresja: <span>${d} - ${interp(d, [9,13,20,27])}</span></div>
            <div class="res-line">Lęk: <span>${a} - ${interp(a, [7,9,14,19])}</span></div>
            <div class="res-line">Stres: <span>${s} - ${interp(s, [14,18,25,33])}</span></div>
        `;
        document.getElementById('res-dass').style.display = 'block';
    }

    function calcPHQ() {
        let sum = 0;
        document.querySelectorAll('#f-phq9 input:checked').forEach(i => sum += parseInt(i.value));
        const txt = sum<=4?"Norma":sum<=9?"Łagodna":sum<=14?"Umiarkowana":sum<=19?"Umiarkowanie ciężka":"Ciężka";
        document.getElementById('res-phq9').innerHTML = `<h3>Suma PHQ-9: ${sum}</h3><p>Interpretacja: ${txt}</p>`;
        document.getElementById('res-phq9').style.display = 'block';
    }

    function calcGAD() {
        let sum = 0;
        document.querySelectorAll('#f-gad7 input:checked').forEach(i => sum += parseInt(i.value));
        const txt = sum<=4?"Norma":sum<=9?"Łagodny":sum<=14?"Umiarkowany":"Silny";
        document.getElementById('res-gad7').innerHTML = `<h3>Suma GAD-7: ${sum}</h3><p>Interpretacja: ${txt}</p>`;
        document.getElementById('res-gad7').style.display = 'block';
    }

    function calcBDI() {
        let sum = 0;
        document.querySelectorAll('#f-bdi input:checked').forEach(i => sum += parseInt(i.value));
        let interpretation = "";
        if (sum <= 13) interpretation = "Minimalna depresja.";
        else if (sum <= 19) interpretation = "Łagodna depresja.";
        else if (sum <= 28) interpretation = "Umiarkowana depresja.";
        else interpretation = "Ciężka depresja.";

        document.getElementById('res-bdi').innerHTML = `<h3>Suma BDI-II: ${sum} pkt</h3><p>Interpretacja: ${interpretation}</p>`;
        document.getElementById('res-bdi').style.display = 'block';
    }
</script>

</body>
</html>
