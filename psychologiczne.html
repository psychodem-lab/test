<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel Psychologa - System Diagnostyczny</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #2563eb;
            --bg: #f8fafc;
            --surface: #ffffff;
            --text: #0f172a;
            --muted: #64748b;
            --border: #e2e8f0;
            --accent: #4f46e5;
        }

        /* --- Global Reset & Mobile --- */
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg);
            color: var(--text);
            line-height: 1.5;
            -webkit-tap-highlight-color: transparent;
        }

        /* --- Login Screen --- */
        #login-screen {
            position: fixed; inset: 0; background: var(--bg);
            display: flex; align-items: center; justify-content: center; z-index: 2000;
            padding: 20px;
        }
        .login-card {
            background: var(--surface); padding: 2rem; border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.05); width: 100%; max-width: 400px;
            text-align: center;
        }
        .login-card h2 { margin-bottom: 1.5rem; }
        .login-card input {
            width: 100%; padding: 0.8rem; margin-bottom: 1rem;
            border: 1px solid var(--border); border-radius: 8px; font-size: 1rem;
        }

        /* --- Dashboard Layout --- */
        #dashboard { display: none; padding: 1rem; max-width: 900px; margin: 0 auto; }
        
        header {
            background: var(--surface); padding: 1.5rem; border-radius: 12px;
            margin-bottom: 1rem; border: 1px solid var(--border);
        }
        .patient-data {
            display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 1rem;
        }
        input[type="text"], input[type="date"] {
            width: 100%; padding: 0.6rem; border: 1px solid var(--border); border-radius: 6px;
            font-family: inherit; font-size: 0.9rem;
        }

        /* --- Tabs Mobile Friendly --- */
        .nav-tabs {
            display: flex; gap: 8px; overflow-x: auto; padding-bottom: 8px;
            margin-bottom: 1.5rem; scrollbar-width: none;
        }
        .nav-tabs::-webkit-scrollbar { display: none; }
        .tab-link {
            flex: 0 0 auto; background: var(--surface); border: 1px solid var(--border);
            padding: 8px 16px; border-radius: 20px; cursor: pointer; font-size: 0.85rem;
            font-weight: 500; transition: 0.2s;
        }
        .tab-link.active { background: var(--primary); color: white; border-color: var(--primary); }

        /* --- Test Content --- */
        .test-section { display: none; background: var(--surface); border-radius: 12px; padding: 1.5rem; border: 1px solid var(--border); }
        .test-section.active { display: block; }
        .test-header { margin-bottom: 1.5rem; border-bottom: 1px solid var(--border); padding-bottom: 1rem; }
        .test-header h2 { font-size: 1.25rem; }
        .test-header p { font-size: 0.85rem; color: var(--muted); margin-top: 4px; }

        /* --- Question UI --- */
        .question-row { margin-bottom: 1.5rem; }
        .q-text { font-weight: 500; display: block; margin-bottom: 0.75rem; font-size: 0.95rem; }
        .options-group { display: flex; gap: 8px; flex-wrap: wrap; }
        
        .opt-label {
            flex: 1; min-width: 60px; display: flex; flex-direction: column; align-items: center;
            padding: 10px; border: 1px solid var(--border); border-radius: 8px; cursor: pointer;
            font-size: 0.8rem; transition: 0.2s;
        }
        .opt-label:hover { background: #f1f5f9; }
        .opt-label input { margin-bottom: 4px; }
        .opt-label input:checked + span { font-weight: 700; color: var(--primary); }

        /* --- Result Styling --- */
        .result-panel {
            margin-top: 2rem; padding: 1rem; background: #f1f5f9; border-radius: 8px;
            border-left: 4px solid var(--primary); display: none;
        }
        .res-line { display: flex; justify-content: space-between; margin-bottom: 0.4rem; }
        .severity { font-weight: bold; }

        /* --- Action Buttons --- */
        .actions {
            position: sticky; bottom: 20px; left: 0; right: 0; 
            display: flex; gap: 10px; justify-content: center; padding: 10px;
        }
        .btn {
            padding: 12px 24px; border-radius: 30px; border: none; font-weight: 600;
            cursor: pointer; font-size: 0.9rem; box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .btn-calc { background: var(--accent); color: white; }
        .btn-print { background: #10b981; color: white; }

        /* --- PRINT STYLES --- */
        @media print {
            body { background: white; }
            #login-screen, .nav-tabs, .actions, .btn-calc, header h1, header p:not(.print-only) { display: none !important; }
            #dashboard { padding: 0; margin: 0; display: block !important; }
            .test-section { display: none !important; border: none !important; padding: 0 !important; }
            .test-section.active { display: block !important; }
            .opt-label { border: 1px solid #ccc !important; -webkit-print-color-adjust: exact; }
            .result-panel { display: block !important; background: #eee !important; border: 1px solid #000 !important; }
            header { border: none; border-bottom: 2px solid #000; margin-bottom: 20px; }
            .patient-data { grid-template-columns: 1fr 1fr; margin-bottom: 20px; }
            input { border: none !important; font-weight: bold; }
        }

        /* Responsive Fixes */
        @media (max-width: 600px) {
            .patient-data { grid-template-columns: 1fr; }
            .options-group { display: grid; grid-template-columns: 1fr 1fr; }
            .opt-label { min-width: unset; }
        }
        
    </style>
</head>
<body>

<div id="login-screen">
    <div class="login-card">
        <h2>Panel Psychologa</h2>
        <input type="password" id="pass" placeholder="Hasło">
        <button class="btn btn-calc" style="width:100%" onclick="login()">Zaloguj się</button>
    </div>
</div>

<div id="dashboard">
    <header id="main-header">
        <h1>System Diagnostyczny</h1>
        <div class="patient-data">
            <div>
                <label style="font-size:0.7rem; color:var(--muted)">Inicjały Pacjenta</label>
                <input type="text" id="p-init" placeholder="np. A.B.">
            </div>
            <div>
                <label style="font-size:0.7rem; color:var(--muted)">Data badania</label>
                <input type="date" id="p-date">
            </div>
        </div>
    </header>

    <nav class="nav-tabs">
        <button class="tab-link active" onclick="openTab(event, 't-dass')">DASS-21</button>
        <button class="tab-link" onclick="openTab(event, 't-phq9')">PHQ-9</button>
        <button class="tab-link" onclick="openTab(event, 't-gad7')">GAD-7</button>
        <button class="tab-link" onclick="openTab(event, 't-bdi')">BDI</button>
        <button class="tab-link" onclick="openTab(event, 't-ybocs')">Y-BOCS</button>
    </nav>

    <div id="t-dass" class="test-section active">
        <div class="test-header">
            <h2>DASS-21</h2>
            <p>Skala Depresji, Lęku i Stresu. </p> <br>
            <p>Nie odnosiło się to do mnie w ogóle 0-3 Odnosiło się to do mnie w bardzo dużym stopniu lub przez większość czasu.</p>
        </div>
        <form id="f-dass"></form>
        <div id="res-dass" class="result-panel"></div>
    </div>

    <div id="t-phq9" class="test-section">
        <div class="test-header">
            <h2>PHQ-9</h2>
            <p>Kwestionariusz Zdrowia Pacjenta (Depresja).</p>
        </div>
        <form id="f-phq9"></form>
        <div id="res-phq9" class="result-panel"></div>
    </div>

    <div id="t-gad7" class="test-section">
        <div class="test-header">
            <h2>GAD-7</h2>
            <p>Skala Lęku Uogólnionego.</p>
        </div>
        <form id="f-gad7"></form>
        <div id="res-gad7" class="result-panel"></div>
    </div>

<div class="container">
    <h1>Inwentarz Depresji Becka (BDI)</h1>
    <form id="dbi-form">
        
        <div class="question-block">
            <span class="question-title">1. Smutek</span>
            <label class="option"><input type="radio" name="q1" value="0" required> Nie czuję się smutny(a).</label>
            <label class="option"><input type="radio" name="q1" value="1"> Czuję się smutny(a) przez większość czasu.</label>
            <label class="option"><input type="radio" name="q1" value="2"> Jestem cały czas smutny(a) i nie mogę się od tego uwolnić.</label>
            <label class="option"><input type="radio" name="q1" value="3"> Jestem tak smutny(a) lub nieszczęśliwy(a), że nie mogę tego znieść.</label>
        </div>

        <div class="question-block">
            <span class="question-title">2. Pesymizm</span>
            <label class="option"><input type="radio" name="q2" value="0"> Nie zniechęcam się do przyszłości.</label>
            <label class="option"><input type="radio" name="q2" value="1"> Czuję się bardziej zniechęcony(a) do przyszłości niż dawniej.</label>
            <label class="option"><input type="radio" name="q2" value="2"> Nie spodziewam się, by cokolwiek mi się udało.</label>
            <label class="option"><input type="radio" name="q2" value="3"> Czuję, że moja przyszłość jest beznadziejna i będzie tylko gorzej.</label>
        </div>

        <div class="question-block">
            <span class="question-title">3. Poczucie porażki</span>
            <label class="option"><input type="radio" name="q3" value="0"> Nie czuję się człowiekiem przegranym.</label>
            <label class="option"><input type="radio" name="q3" value="1"> Częściej odnosiłem(am) porażki niż przeciętny człowiek.</label>
            <label class="option"><input type="radio" name="q3" value="2"> Gdy patrzę na swoje życie, widzę w nim wiele porażek.</label>
            <label class="option"><input type="radio" name="q3" value="3"> Czuję, że jako człowiek poniosłem(am) całkowitą klęskę.</label>
        </div>

        <div class="question-block">
            <span class="question-title">4. Utrata przyjemności</span>
            <label class="option"><input type="radio" name="q4" value="0"> Czerpię tyle samo przyjemności z rzeczy, które lubię, co dawniej.</label>
            <label class="option"><input type="radio" name="q4" value="1"> Nie czerpię z nich już tyle przyjemności, co kiedyś.</label>
            <label class="option"><input type="radio" name="q4" value="2"> Czerpię bardzo mało przyjemności z rzeczy, które dawniej sprawiały mi radość.</label>
            <label class="option"><input type="radio" name="q4" value="3"> W ogóle nie czerpię z nich przyjemności.</label>
        </div>

        <div class="question-block">
            <span class="question-title">5. Poczucie winy</span>
            <label class="option"><input type="radio" name="q5" value="0"> Nie mam poczucia winy.</label>
            <label class="option"><input type="radio" name="q5" value="1"> Czuję się winny(a) z powodu wielu rzeczy, które zrobiłem(am) lub powinienem(am) był(a) zrobić.</label>
            <label class="option"><input type="radio" name="q5" value="2"> Przez większość czasu czuję się winny(a).</label>
            <label class="option"><input type="radio" name="q5" value="3"> Cały czas czuję się winny(a).</label>
        </div>

        <div class="question-block">
            <span class="question-title">6. Poczucie kary</span>
            <label class="option"><input type="radio" name="q6" value="0"> Nie czuję się karany(a) przez los.</label>
            <label class="option"><input type="radio" name="q6" value="1"> Czuję, że mogę zostać ukarany(a).</label>
            <label class="option"><input type="radio" name="q6" value="2"> Spodziewam się kary.</label>
            <label class="option"><input type="radio" name="q6" value="3"> Czuję się karany(a).</label>
        </div>

        <div class="question-block">
            <span class="question-title">7. Niechęć do siebie</span>
            <label class="option"><input type="radio" name="q7" value="0"> Mam o sobie taką samą opinię jak dawniej.</label>
            <label class="option"><input type="radio" name="q7" value="1"> Straciłem(am) zaufanie do siebie.</label>
            <label class="option"><input type="radio" name="q7" value="2"> Jestem sobą rozczarowany(a).</label>
            <label class="option"><input type="radio" name="q7" value="3"> Nie lubię siebie (nienawidzę siebie).</label>
        </div>

        <div class="question-block">
            <span class="question-title">8. Samokrytycyzm</span>
            <label class="option"><input type="radio" name="q8" value="0"> Nie krytykuję siebie ani nie obwiniam bardziej niż dawniej.</label>
            <label class="option"><input type="radio" name="q8" value="1"> Jestem bardziej krytyczny(a) wobec siebie niż dawniej.</label>
            <label class="option"><input type="radio" name="q8" value="2"> Krytykuję siebie za wszystkie swoje błędy.</label>
            <label class="option"><input type="radio" name="q8" value="3"> Obwiniam siebie za wszystko, co złe.</label>
        </div>

        <div class="question-block">
            <span class="question-title">9. Myśli i tendencje samobójcze</span>
            <label class="option"><input type="radio" name="q9" value="0"> Nie myślę o odebraniu sobie życia.</label>
            <label class="option"><input type="radio" name="q9" value="1"> Mam myśli o odebraniu sobie życia, ale nie potrafiłbym(ałabym) tego zrobić.</label>
            <label class="option"><input type="radio" name="q9" value="2"> Chciałbym(ałabym) odebrać sobie życie.</label>
            <label class="option"><input type="radio" name="q9" value="3"> Odebrałbym(ałabym) sobie życie, gdyby nadarzyła się okazja.</label>
        </div>

        <div class="question-block">
            <span class="question-title">10. Płaczliwość</span>
            <label class="option"><input type="radio" name="q10" value="0"> Płaczę tyle samo co dawniej.</label>
            <label class="option"><input type="radio" name="q10" value="1"> Płaczę częściej niż dawniej.</label>
            <label class="option"><input type="radio" name="q10" value="2"> Płaczę z powodu każdego drobiazgu.</label>
            <label class="option"><input type="radio" name="q10" value="3"> Chciałbym(ałabym) płakać, ale nie potrafię.</label>
        </div>

        <div class="question-block">
            <span class="question-title">11. Pobudzenie (Irytacja)</span>
            <label class="option"><input type="radio" name="q11" value="0"> Nie jestem bardziej podenerwowany(a) niż zazwyczaj.</label>
            <label class="option"><input type="radio" name="q11" value="1"> Jestem bardziej podenerwowany(a) i niespokojny(a) niż zazwyczaj.</label>
            <label class="option"><input type="radio" name="q11" value="2"> Jestem tak podenerwowany(a), że trudno mi ustać w miejscu.</label>
            <label class="option"><input type="radio" name="q11" value="3"> Jestem tak podenerwowany(a), że muszę być w ciągłym ruchu.</label>
        </div>

        <div class="question-block">
            <span class="question-title">12. Utrata zainteresowań</span>
            <label class="option"><input type="radio" name="q12" value="0"> Nie straciłem(am) zainteresowania innymi ludźmi ani aktywnościami.</label>
            <label class="option"><input type="radio" name="q12" value="1"> Mniej niż dawniej interesuję się ludźmi lub rzeczami.</label>
            <label class="option"><input type="radio" name="q12" value="2"> Straciłem(am) większość zainteresowań innymi ludźmi i sprawami.</label>
            <label class="option"><input type="radio" name="q12" value="3"> Trudno mi się czymkolwiek zainteresować.</label>
        </div>

        <div class="question-block">
            <span class="question-title">13. Trudności w podejmowaniu decyzji</span>
            <label class="option"><input type="radio" name="q13" value="0"> Podejmuję decyzje tak łatwo jak dawniej.</label>
            <label class="option"><input type="radio" name="q13" value="1"> Podejmowanie decyzji przychodzi mi trudniej niż dawniej.</label>
            <label class="option"><input type="radio" name="q13" value="2"> Mam znacznie większe trudności z podejmowaniem decyzji niż dawniej.</label>
            <label class="option"><input type="radio" name="q13" value="3"> Mam trudności z podjęciem jakiejkolwiek decyzji.</label>
        </div>

        <div class="question-block">
            <span class="question-title">14. Poczucie bezwartościowości</span>
            <label class="option"><input type="radio" name="q14" value="0"> Nie czuję się człowiekiem bezwartościowym.</label>
            <label class="option"><input type="radio" name="q14" value="1"> Nie uważam się za tak wartościowego człowieka, jak dawniej.</label>
            <label class="option"><input type="radio" name="q14" value="2"> Czuję się mniej wartościowy(a) niż inni ludzie.</label>
            <label class="option"><input type="radio" name="q14" value="3"> Czuję się całkowicie bezwartościowy(a).</label>
        </div>

        <div class="question-block">
            <span class="question-title">15. Brak energii</span>
            <label class="option"><input type="radio" name="q15" value="0"> Mam tyle samo energii co dawniej.</label>
            <label class="option"><input type="radio" name="q15" value="1"> Mam mniej energii niż dawniej.</label>
            <label class="option"><input type="radio" name="q15" value="2"> Nie mam dość energii, aby zrobić wiele rzeczy.</label>
            <label class="option"><input type="radio" name="q15" value="3"> Nie mam energii na nic.</label>
        </div>

        <div class="question-block">
            <span class="question-title">16. Zmiany w rytmie snu</span>
            <label class="option"><input type="radio" name="q16" value="0"> Nie zauważyłem(am) żadnych zmian w moim śpaniu.</label>
            <label class="option"><input type="radio" name="q16" value="1"> Śpię nieco więcej/mniej niż zwykle.</label>
            <label class="option"><input type="radio" name="q16" value="2"> Śpię znacznie więcej/mniej niż zwykle.</label>
            <label class="option"><input type="radio" name="q16" value="3"> Śpię przez większość dnia / Budzę się bardzo wcześnie i nie mogę zasnąć.</label>
        </div>

        <div class="question-block">
            <span class="question-title">17. Drażliwość</span>
            <label class="option"><input type="radio" name="q17" value="0"> Nie jestem bardziej drażliwy(a) niż zwykle.</label>
            <label class="option"><input type="radio" name="q17" value="1"> Jestem bardziej drażliwy(a) niż zwykle.</label>
            <label class="option"><input type="radio" name="q17" value="2"> Jestem znacznie bardziej drażliwy(a) niż zwykle.</label>
            <label class="option"><input type="radio" name="q17" value="3"> Jestem cały czas drażliwy(a).</label>
        </div>

        <div class="question-block">
            <span class="question-title">18. Zmiany apetytu</span>
            <label class="option"><input type="radio" name="q18" value="0"> Nie zauważyłem(am) żadnych zmian w apetycie.</label>
            <label class="option"><input type="radio" name="q18" value="1"> Mam nieco mniejszy/większy apetyt niż zwykle.</label>
            <label class="option"><input type="radio" name="q18" value="2"> Mam znacznie mniejszy/większy apetyt niż zwykle.</label>
            <label class="option"><input type="radio" name="q18" value="3"> Zupełnie nie mam apetytu / Mam niepohamowany apetyt.</label>
        </div>

        <div class="question-block">
            <span class="question-title">19. Trudności w koncentracji</span>
            <label class="option"><input type="radio" name="q19" value="0"> Mogę się koncentrować tak dobrze jak dawniej.</label>
            <label class="option"><input type="radio" name="q19" value="1"> Nie mogę się koncentrować tak dobrze jak dawniej.</label>
            <label class="option"><input type="radio" name="q19" value="2"> Trudno mi przez dłuższy czas skupić uwagę na czymkolwiek.</label>
            <label class="option"><input type="radio" name="q19" value="3"> Nie mogę się w ogóle na niczym skupić.</label>
        </div>

        <div class="question-block">
            <span class="question-title">20. Zmęczenie i znużenie</span>
            <label class="option"><input type="radio" name="q20" value="0"> Nie czuję się bardziej zmęczony(a) ani znużony(a) niż dawniej.</label>
            <label class="option"><input type="radio" name="q20" value="1"> Szybciej męczę się i nużę niż dawniej.</label>
            <label class="option"><input type="radio" name="q20" value="2"> Jestem zbyt zmęczony(a), aby robić wiele rzeczy, które dawniej robiłem(am).</label>
            <label class="option"><input type="radio" name="q20" value="3"> Jestem zbyt zmęczony(a), aby cokolwiek robić.</label>
        </div>

        <div class="question-block">
            <span class="question-title">21. Utrata zainteresowania seksem</span>
            <label class="option"><input type="radio" name="q21" value="0"> Nie zauważyłem(am) żadnej zmiany w moich zainteresowaniach seksualnych.</label>
            <label class="option"><input type="radio" name="q21" value="1"> Mniej interesuję się seksem niż dawniej.</label>
            <label class="option"><input type="radio" name="q21" value="2"> Obecnie znacznie mniej interesuję się seksem.</label>
            <label class="option"><input type="radio" name="q21" value="3"> Całkowicie straciłem(am) zainteresowanie seksem.</label>
        </div>

        <button type="button" onclick="calculateScore()">Oblicz wynik</button>
    </form>

    <div id="result"></div>
</div>

    <div id="t-ybocs" class="test-section">
        <div class="test-header">
            <h2>Y-BOCS (Szablon)</h2>
            <p>Skala Yale-Brown (Obsesje i Kompulsje).</p>
        </div>
        <form id="f-ybocs"></form>
    </div>

    <div class="actions">
        <button class="btn btn-calc" onclick="calculateCurrent()">Oblicz wynik</button>
        <button class="btn btn-print" onclick="window.print()">Zapisz jako PDF / Drukuj</button>
    </div>
</div>

<script>
    const PASS = "psycholog2026";

    function login() {
        if(document.getElementById('pass').value === PASS) {
            document.getElementById('login-screen').style.display = 'none';
            document.getElementById('dashboard').style.display = 'block';
            document.getElementById('p-date').valueAsDate = new Date();
            initTests();
        } else alert("Błędne hasło");
    }

    function openTab(evt, id) {
        document.querySelectorAll('.test-section').forEach(s => s.classList.remove('active'));
        document.querySelectorAll('.tab-link').forEach(b => b.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        evt.currentTarget.classList.add('active');
    }

    function initTests() {
        // DASS-21
        const dQ = ["Bardzo trudno było mi się odprężyć", "Odczuwałem/am suchość w ustach", "Nie mogłem/am doświadczać żadnych pozytywnych uczuć", "Trudności z oddychaniem (bez wcześniejszego wysiłku fizycznego)", "Trudno było mi coś zacząć ", "Miałem/am tendencję do nadmiernego reagowania na różne sytuacje", "Odczywałem/am drżenia (np. rąk)", "Używałem/am dużo nerwowej energii", "Obawiałem/am się sytuacji, kiedy mógłbym/abym wpaść w panikę i zrobić z siebie głupca", "Czułem/am, że nic mnie już w życiu nie spotka", "Czułem/am się podminowany", "Trudno było mi się zrelaksować", "Czułem/am się przybity i smutny", "Nie mogłem/am znieść, jak cokolwiek przeszkadzało mi w tym, co akurat robiłem", "Czułem/am, że jestem bliski wpadnięcia w panikę", "Nie mogłem/am się z niczego ucieszyć", "Czułem/am się niewartościową osobą", "Czułem/am, że jestem raczej przewrażliwiony", "Czułem/am bicie swojego serca, kiedy nie wykonywałem/am żadnego wysiłku fizycznego", "Czułem/am się przestraszony bez żadnego powodu", "Czułem/am, że życie jest bezwartościowe"];
        genForm('f-dass', dQ, 4, 'd');

        // PHQ-9
        const pQ = ["Małe zainteresowanie/radość", "Przygnębienie/beznadzieja", "Problemy ze snem", "Zmęczenie/brak energii", "Apetyt (brak/nadmiar)", "Poczucie porażki", "Problemy z koncentracją", "Spowolnienie/pobudzenie", "Myśli o samookaleczeniu"];
        genForm('f-phq9', pQ, 4, 'p', ["Wcale", "Kilka dni", "Połowa dni", "Codziennie"]);

        // GAD-7
        const gQ = ["Zdenerwowanie/lęk", "Brak kontroli nad martwieniem", "Martwienie się na zapas", "Trudno się odprężyć", "Niepokój ruchowy", "Irytacja", "Strach przed najgorszym"];
        genForm('f-gad7', gQ, 4, 'g', ["Wcale", "Kilka dni", "Połowa dni", "Codziennie"]);

        // BDI & YBOCS (Placeholders)
        genForm('f-bdi', Array(21).fill("Pytanie arkuszowe"), 4, 'b');
        genForm('f-ybocs', Array(10).fill("Pytanie arkuszowe"), 5, 'y');
    }

    function genForm(id, qs, n, prefix, labels=null) {
        const f = document.getElementById(id);
        f.innerHTML = qs.map((q, i) => `
            <div class="question-row">
                <span class="q-text">${i+1}. ${q}</span>
                <div class="options-group">
                    ${Array(n).fill(0).map((_, v) => `
                        <label class="opt-label">
                            <input type="radio" name="${prefix}${i}" value="${v}">
                            <span>${labels ? labels[v] : v}</span>
                        </label>
                    `).join('')}
                </div>
            </div>
        `).join('');
    }

    function calculateCurrent() {
        const activeId = document.querySelector('.test-section.active').id;
        if(activeId === 't-dass') calcDASS();
        if(activeId === 't-phq9') calcPHQ();
        if(activeId === 't-gad7') calcGAD();
    }

    function calcDASS() {
        const getSum = (idx) => {
            let s = 0;
            idx.forEach(i => {
                const r = document.querySelector(`input[name="d${i}"]:checked`);
                if(r) s += parseInt(r.value);
            });
            return s * 2;
        };
        const d = getSum([2,4,9,12,15,16,20]);
        const a = getSum([1,3,6,8,14,18,19]);
        const s = getSum([0,5,7,10,11,13,17]);

        const interp = (v, th) => v<=th[0]?"Norma":v<=th[1]?"Łagodny":v<=th[2]?"Umiarkowany":v<=th[3]?"Silny":"B. Silny";
        
        document.getElementById('res-dass').innerHTML = `
            <h3>Wyniki DASS-21 (Skalowane x2):</h3>
            <div class="res-line">Depresja: <span>${d} - ${interp(d, [9,13,20,27])}</span></div>
            <div class="res-line">Lęk: <span>${a} - ${interp(a, [7,9,14,19])}</span></div>
            <div class="res-line">Stres: <span>${s} - ${interp(s, [14,18,25,33])}</span></div>
        `;
        document.getElementById('res-dass').style.display = 'block';
    }

    function calcPHQ() {
        let sum = 0;
        document.querySelectorAll('#f-phq9 input:checked').forEach(i => sum += parseInt(i.value));
        const txt = sum<=4?"Norma":sum<=9?"Łagodna":sum<=14?"Umiarkowana":sum<=19?"Umiarkowanie ciężka":"Ciężka";
        document.getElementById('res-phq9').innerHTML = `<h3>Suma PHQ-9: ${sum}</h3><p>Interpretacja: ${txt}</p>`;
        document.getElementById('res-phq9').style.display = 'block';
    }

    function calcGAD() {
        let sum = 0;
        document.querySelectorAll('#f-gad7 input:checked').forEach(i => sum += parseInt(i.value));
        const txt = sum<=4?"Norma":sum<=9?"Łagodny":sum<=14?"Umiarkowany":"Silny";
        document.getElementById('res-gad7').innerHTML = `<h3>Suma GAD-7: ${sum}</h3><p>Interpretacja: ${txt}</p>`;
        document.getElementById('res-gad7').style.display = 'block';
    }

    function calculateScore() {
        const form = document.getElementById('dbi-form');
        const formData = new FormData(form);
        let totalScore = 0;
        let answeredQuestions = 0;

        for (let value of formData.values()) {
            totalScore += parseInt(value);
            answeredQuestions++;
        }

        const totalExpected = 21; // Zaktualizowano do pełnej liczby pytań

        if (answeredQuestions < totalExpected) {
            document.getElementById('result').innerText = "Proszę odpowiedzieć na wszystkie pytania.";
            return;
        }

        let interpretation = "";
        // Progi punktowe według standardowej interpretacji polskiej adaptacji BDI-II:
        if (totalScore <= 13) interpretation = "Minimalna depresja.";
        else if (totalScore <= 19) interpretation = "Lekka depresja.";
        else if (totalScore <= 28) interpretation = "Umiarkowana depresja.";
        else interpretation = "Ciężka depresja.";

        document.getElementById('result').innerHTML = `Twój wynik: ${totalScore} pkt<br>Interpretacja: ${interpretation}`;
    }


    
</script>

</body>
</html>
