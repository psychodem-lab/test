<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel Psychologa - System Diagnostyczny</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #2563eb;
            --bg: #f8fafc;
            --surface: #ffffff;
            --text: #0f172a;
            --muted: #64748b;
            --border: #e2e8f0;
            --accent: #4f46e5;
        }

        /* --- Global Reset & Mobile --- */
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg);
            color: var(--text);
            line-height: 1.5;
            -webkit-tap-highlight-color: transparent;
        }

        /* --- Login Screen --- */
        #login-screen {
            position: fixed; inset: 0; background: var(--bg);
            display: flex; align-items: center; justify-content: center; z-index: 2000;
            padding: 20px;
        }
        .login-card {
            background: var(--surface); padding: 2rem; border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.05); width: 100%; max-width: 400px;
            text-align: center;
        }
        .login-card h2 { margin-bottom: 1.5rem; }
        .login-card input {
            width: 100%; padding: 0.8rem; margin-bottom: 1rem;
            border: 1px solid var(--border); border-radius: 8px; font-size: 1rem;
        }

        /* --- Dashboard Layout --- */
        #dashboard { display: none; padding: 1rem; max-width: 900px; margin: 0 auto; }
        
        header {
            background: var(--surface); padding: 1.5rem; border-radius: 12px;
            margin-bottom: 1rem; border: 1px solid var(--border);
        }
        .patient-data {
            display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 1rem;
        }
        input[type="text"], input[type="date"] {
            width: 100%; padding: 0.6rem; border: 1px solid var(--border); border-radius: 6px;
            font-family: inherit; font-size: 0.9rem;
        }

        /* --- Tabs Mobile Friendly --- */
        .nav-tabs {
            display: flex; gap: 8px; overflow-x: auto; padding-bottom: 8px;
            margin-bottom: 1.5rem; scrollbar-width: none;
        }
        .nav-tabs::-webkit-scrollbar { display: none; }
        .tab-link {
            flex: 0 0 auto; background: var(--surface); border: 1px solid var(--border);
            padding: 8px 16px; border-radius: 20px; cursor: pointer; font-size: 0.85rem;
            font-weight: 500; transition: 0.2s;
        }
        .tab-link.active { background: var(--primary); color: white; border-color: var(--primary); }

        /* --- Test Content --- */
        .test-section { display: none; background: var(--surface); border-radius: 12px; padding: 1.5rem; border: 1px solid var(--border); }
        .test-section.active { display: block; }
        .test-header { margin-bottom: 1.5rem; border-bottom: 1px solid var(--border); padding-bottom: 1rem; }
        .test-header h2 { font-size: 1.25rem; }
        .test-header p { font-size: 0.85rem; color: var(--muted); margin-top: 4px; }

        /* --- Question UI --- */
        .question-row { margin-bottom: 1.5rem; }
        .q-text { font-weight: 500; display: block; margin-bottom: 0.75rem; font-size: 0.95rem; }
        .options-group { display: flex; gap: 8px; flex-wrap: wrap; }
        
        .opt-label {
            flex: 1; min-width: 60px; display: flex; flex-direction: column; align-items: center;
            padding: 10px; border: 1px solid var(--border); border-radius: 8px; cursor: pointer;
            font-size: 0.8rem; transition: 0.2s;
        }
        .opt-label:hover { background: #f1f5f9; }
        .opt-label input { margin-bottom: 4px; }
        .opt-label input:checked + span { font-weight: 700; color: var(--primary); }

        /* --- Result Styling --- */
        .result-panel {
            margin-top: 2rem; padding: 1rem; background: #f1f5f9; border-radius: 8px;
            border-left: 4px solid var(--primary); display: none;
        }
        .res-line { display: flex; justify-content: space-between; margin-bottom: 0.4rem; }
        .severity { font-weight: bold; }

        /* --- Action Buttons --- */
        .actions {
            position: sticky; bottom: 20px; left: 0; right: 0; 
            display: flex; gap: 10px; justify-content: center; padding: 10px;
        }
        .btn {
            padding: 12px 24px; border-radius: 30px; border: none; font-weight: 600;
            cursor: pointer; font-size: 0.9rem; box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .btn-calc { background: var(--accent); color: white; }
        .btn-print { background: #10b981; color: white; }

        /* --- PRINT STYLES --- */
        @media print {
            body { background: white; }
            #login-screen, .nav-tabs, .actions, .btn-calc, header h1, header p:not(.print-only) { display: none !important; }
            #dashboard { padding: 0; margin: 0; display: block !important; }
            .test-section { display: none !important; border: none !important; padding: 0 !important; }
            .test-section.active { display: block !important; }
            .opt-label { border: 1px solid #ccc !important; -webkit-print-color-adjust: exact; }
            .result-panel { display: block !important; background: #eee !important; border: 1px solid #000 !important; }
            header { border: none; border-bottom: 2px solid #000; margin-bottom: 20px; }
            .patient-data { grid-template-columns: 1fr 1fr; margin-bottom: 20px; }
            input { border: none !important; font-weight: bold; }
        }

        /* Responsive Fixes */
        @media (max-width: 600px) {
            .patient-data { grid-template-columns: 1fr; }
            .options-group { display: grid; grid-template-columns: 1fr 1fr; }
            .opt-label { min-width: unset; }
        }
    </style>
</head>
<body>

<div id="login-screen">
    <div class="login-card">
        <h2>Panel Psychologa</h2>
        <input type="password" id="pass" placeholder="Hasło">
        <button class="btn btn-calc" style="width:100%" onclick="login()">Zaloguj się</button>
    </div>
</div>

<div id="dashboard">
    <header id="main-header">
        <h1>System Diagnostyczny</h1>
        <div class="patient-data">
            <div>
                <label style="font-size:0.7rem; color:var(--muted)">Inicjały Pacjenta</label>
                <input type="text" id="p-init" placeholder="np. J.K.">
            </div>
            <div>
                <label style="font-size:0.7rem; color:var(--muted)">Data badania</label>
                <input type="date" id="p-date">
            </div>
        </div>
    </header>

    <nav class="nav-tabs">
        <button class="tab-link active" onclick="openTab(event, 't-dass')">DASS-21</button>
        <button class="tab-link" onclick="openTab(event, 't-phq9')">PHQ-9</button>
        <button class="tab-link" onclick="openTab(event, 't-gad7')">GAD-7</button>
        <button class="tab-link" onclick="openTab(event, 't-bdi')">BDI</button>
        <button class="tab-link" onclick="openTab(event, 't-ybocs')">Y-BOCS</button>
    </nav>

    <div id="t-dass" class="test-section active">
        <div class="test-header">
            <h2>DASS-21</h2>
            <p>Skala Depresji, Lęku i Stresu (Wyniki x2). Norma: 0-3.</p>
        </div>
        <form id="f-dass"></form>
        <div id="res-dass" class="result-panel"></div>
    </div>

    <div id="t-phq9" class="test-section">
        <div class="test-header">
            <h2>PHQ-9</h2>
            <p>Kwestionariusz Zdrowia Pacjenta (Depresja).</p>
        </div>
        <form id="f-phq9"></form>
        <div id="res-phq9" class="result-panel"></div>
    </div>

    <div id="t-gad7" class="test-section">
        <div class="test-header">
            <h2>GAD-7</h2>
            <p>Skala Lęku Uogólnionego.</p>
        </div>
        <form id="f-gad7"></form>
        <div id="res-gad7" class="result-panel"></div>
    </div>

    <div id="t-bdi" class="test-section">
        <div class="test-header">
            <h2>BDI-II (Szablon)</h2>
            <p>Uzupełnij pytania zgodnie z arkuszem Becka.</p>
        </div>
        <form id="f-bdi"></form>
    </div>

    <div id="t-ybocs" class="test-section">
        <div class="test-header">
            <h2>Y-BOCS (Szablon)</h2>
            <p>Skala Yale-Brown (Obsesje i Kompulsje).</p>
        </div>
        <form id="f-ybocs"></form>
    </div>

    <div class="actions">
        <button class="btn btn-calc" onclick="calculateCurrent()">Oblicz wynik</button>
        <button class="btn btn-print" onclick="window.print()">Zapisz jako PDF / Drukuj</button>
    </div>
</div>

<script>
    const PASS = "psycholog2026";

    function login() {
        if(document.getElementById('pass').value === PASS) {
            document.getElementById('login-screen').style.display = 'none';
            document.getElementById('dashboard').style.display = 'block';
            document.getElementById('p-date').valueAsDate = new Date();
            initTests();
        } else alert("Błędne hasło");
    }

    function openTab(evt, id) {
        document.querySelectorAll('.test-section').forEach(s => s.classList.remove('active'));
        document.querySelectorAll('.tab-link').forEach(b => b.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        evt.currentTarget.classList.add('active');
    }

    function initTests() {
        // DASS-21
        const dQ = ["Bardzo trudno było mi się odprężyć", "Odczuwałem/am suchość w ustach", "Nie mogłem/am doświadczać żadnych pozytywnych uczuć", "Trudności z oddychaniem (bez wcześniejszego wysiłku fizycznego)", "Trudno było mi coś zacząć ", "Miałem/am tendencję do nadmiernego reagowania na różne sytuacje", "Odczywałem/am drżenia (np. rąk)", "Używałem/am dużo nerwowej energii", "Obawiałem/am się sytuacji, kiedy mógłbym/abym wpaść w panikę i zrobić z siebie głupca", "Czułem/am, że nic mnie już w życiu nie spotka", "Czułem/am się podminowany", "Trudno było mi się zrelaksować", "Czułem/am się przybity i smutny", "Nie mogłem/am znieść, jak cokolwiek przeszkadzało mi w tym, co akurat robiłem", "Czułem/am, że jestem bliski wpadnięcia w panikę", "Nie mogłem/am się z niczego ucieszyć", "Czułem/am się niewartościową osobą", "Czułem/am, że jestem raczej przewrażliwiony", "Czułem/am bicie swojego serca, kiedy nie wykonywałem/am żadnego wysiłku fizycznego", "Czułem/am się przestraszony bez żadnego powodu", "Czułem/am, że życie jest bezwartościowe"];
        genForm('f-dass', dQ, 4, 'd');

        // PHQ-9
        const pQ = ["Małe zainteresowanie/radość", "Przygnębienie/beznadzieja", "Problemy ze snem", "Zmęczenie/brak energii", "Apetyt (brak/nadmiar)", "Poczucie porażki", "Problemy z koncentracją", "Spowolnienie/pobudzenie", "Myśli o samookaleczeniu"];
        genForm('f-phq9', pQ, 4, 'p', ["Wcale", "Kilka dni", "Połowa dni", "Codziennie"]);

        // GAD-7
        const gQ = ["Zdenerwowanie/lęk", "Brak kontroli nad martwieniem", "Martwienie się na zapas", "Trudno się odprężyć", "Niepokój ruchowy", "Irytacja", "Strach przed najgorszym"];
        genForm('f-gad7', gQ, 4, 'g', ["Wcale", "Kilka dni", "Połowa dni", "Codziennie"]);

        // BDI & YBOCS (Placeholders)
        genForm('f-bdi', Array(21).fill("Pytanie arkuszowe"), 4, 'b');
        genForm('f-ybocs', Array(10).fill("Pytanie arkuszowe"), 5, 'y');
    }

    function genForm(id, qs, n, prefix, labels=null) {
        const f = document.getElementById(id);
        f.innerHTML = qs.map((q, i) => `
            <div class="question-row">
                <span class="q-text">${i+1}. ${q}</span>
                <div class="options-group">
                    ${Array(n).fill(0).map((_, v) => `
                        <label class="opt-label">
                            <input type="radio" name="${prefix}${i}" value="${v}">
                            <span>${labels ? labels[v] : v}</span>
                        </label>
                    `).join('')}
                </div>
            </div>
        `).join('');
    }

    function calculateCurrent() {
        const activeId = document.querySelector('.test-section.active').id;
        if(activeId === 't-dass') calcDASS();
        if(activeId === 't-phq9') calcPHQ();
        if(activeId === 't-gad7') calcGAD();
    }

    function calcDASS() {
        const getSum = (idx) => {
            let s = 0;
            idx.forEach(i => {
                const r = document.querySelector(`input[name="d${i}"]:checked`);
                if(r) s += parseInt(r.value);
            });
            return s * 2;
        };
        const d = getSum([2,4,9,12,15,16,20]);
        const a = getSum([1,3,6,8,14,18,19]);
        const s = getSum([0,5,7,10,11,13,17]);

        const interp = (v, th) => v<=th[0]?"Norma":v<=th[1]?"Łagodny":v<=th[2]?"Umiarkowany":v<=th[3]?"Silny":"B. Silny";
        
        document.getElementById('res-dass').innerHTML = `
            <h3>Wyniki DASS-21 (Skalowane x2):</h3>
            <div class="res-line">Depresja: <span>${d} - ${interp(d, [9,13,20,27])}</span></div>
            <div class="res-line">Lęk: <span>${a} - ${interp(a, [7,9,14,19])}</span></div>
            <div class="res-line">Stres: <span>${s} - ${interp(s, [14,18,25,33])}</span></div>
        `;
        document.getElementById('res-dass').style.display = 'block';
    }

    function calcPHQ() {
        let sum = 0;
        document.querySelectorAll('#f-phq9 input:checked').forEach(i => sum += parseInt(i.value));
        const txt = sum<=4?"Norma":sum<=9?"Łagodna":sum<=14?"Umiarkowana":sum<=19?"Umiarkowanie ciężka":"Ciężka";
        document.getElementById('res-phq9').innerHTML = `<h3>Suma PHQ-9: ${sum}</h3><p>Interpretacja: ${txt}</p>`;
        document.getElementById('res-phq9').style.display = 'block';
    }

    function calcGAD() {
        let sum = 0;
        document.querySelectorAll('#f-gad7 input:checked').forEach(i => sum += parseInt(i.value));
        const txt = sum<=4?"Norma":sum<=9?"Łagodny":sum<=14?"Umiarkowany":"Silny";
        document.getElementById('res-gad7').innerHTML = `<h3>Suma GAD-7: ${sum}</h3><p>Interpretacja: ${txt}</p>`;
        document.getElementById('res-gad7').style.display = 'block';
    }
</script>

</body>
</html>
